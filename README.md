## Yii route registry

Демо проект на Yii2 реализующий REST API.
Реализация задания описанного в документе `Тестовое задание HuskyJam. PHP. YII.pdf`

### Установка и запуск

Подготовлена кофигурация docker-compose. Для запуска приложения - в корневом каталоге проекта выполните:
```
docker-compose up
```
При удачном запуске web-итерфейс будет доступен локально на порту 80, а API доступно по адресу `localhost/routes`.

### Тестирование

Для запуска автоматических тестов запустите контейнер и выполните комманду:
```
docker exec -it yii-route-registry_web_1 vendor/bin/codecept run
```
***Примечание:***
Тесты используют "продакшн" БД и ожидают в ней определённые данные, которые заносятся миграциями. Еспи тесты не проходятся попробуйте сбросить БД и накатить миграции заново командой:
```
docker exec -it route-registry_web_1 yii migrate/fresh --interactive 0
```

### API

API доступно по адресу `lokalhost/routes`. Поддерживаются все REST запросы на запрос/создание/модификацию/удаление. По умолчанию возвращаются следующие поля:

поле | описание
-- | --
'id' | ID
'origin' | Станция отправления
'destination' | Станция прибытия
'price' | Цена
'company' | Перевозчик
'scheduleStr' | Строковое представление расписания напр. "пн, ср, сб"
'departureStr' | Время отправления строкой напр. "15:40"
'arrivalStr' | Время прибытия строкой
'longevityStr' | Время в пути строкой

Дополнительно аргументом expand (`localhost/routes?expand=arrival,schedule`) можно запросить поля:

поле | описание
-- | --
'departure' | Время отправления числом в минутах
'arrival' | Время прибытия числом в минутах
'longevity' | Время в пути числом в минутах
'schedule' | Расписание представленное битовой маской, где каждый бит, начиная с младшего, соотносится со днём недели (0b1000111 -> 'пн, вт, ср, вс')

Во все поля можно писать запросами PUT и POST.

### Примечания

Web-интерфейс настороен не полностью некоторые функции могут работать некорректно.

Использован базовый шаблон [Yii2](https://www.yiiframework.com/) и следующие проекты:
1. https://github.com/tabalinas/jsgrid
1. https://github.com/vishnubob/wait-for-it
